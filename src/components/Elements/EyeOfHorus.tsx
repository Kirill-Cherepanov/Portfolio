import { useEffect, useRef } from 'react';

import { useMousePosition } from '@/hooks';

type EyeOfHorusProps = React.SVGProps<SVGSVGElement>;

export function EyeOfHorus(svgProps: EyeOfHorusProps) {
  const mousePos = useMousePosition();
  const eyeballRef = useRef<SVGGElement>(null!);
  const angleDeg = useRef(0);

  useEffect(() => {
    const rekt = eyeballRef.current.getBoundingClientRect();
    const eyeballPos = {
      x: rekt.x + rekt.width / 2 + window.scrollX,
      y: rekt.y + rekt.height / 2 + window.scrollY,
    };
    angleDeg.current = angle(mousePos.x, mousePos.y, eyeballPos.x, eyeballPos.y);

    function angle(cx: number, cy: number, ex: number, ey: number) {
      const dy = ey - cy;
      const dx = ex - cx;
      const rad = Math.atan2(dy, dx);
      const deg = (180 * rad) / Math.PI;
      return deg;
    }
  }, [mousePos]);

  return (
    <svg
      viewBox="0 0 720 500"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
      transform="scale(-1,1)"
      {...svgProps}
    >
      <g ref={eyeballRef} transform={`rotate(${-angleDeg.current} 368 185)`} fill="#be123c">
        <circle cx="418.5" cy="185.5" r="30.5" />
        <circle cx="368" cy="185" r="80.5" strokeWidth={0} fill="none" />
      </g>
      <path
        fill="currentColor"
        d="M498.439 494.958C498.066 492.471 497.971 479.493 498.229 466.119C498.824 435.172 501.708 420.637 523.991 336.302C533.94 298.647 534.937 272.978 526.597 269.179C519.189 265.803 511.487 270.067 499.307 284.289C460.845 329.195 400.384 382.94 352.56 414.733C250.348 482.682 141.719 507.218 77.4678 476.869C30.1038 454.497 6.5118 397.535 23.4979 346.56C39.6966 297.949 102.743 279.912 139.389 313.404C157.644 330.087 153.165 359.553 130.672 370.762C112.494 379.82 89.5381 361.247 95.6233 342.405C97.7556 335.803 97.4047 335.589 88.9214 338.317C39.261 354.285 49.7991 426.843 104.651 446.618C168.038 469.469 267.736 437.845 367.468 363.253C407.023 333.669 454.638 284.55 449.101 279.042C447.475 277.424 425.165 277.837 403.968 279.877C341.704 285.872 267.372 273.728 179.968 243.284C168.693 239.356 152.493 233.735 143.968 230.792C125.6 224.451 91.1939 215.72 67.4678 211.378C58.1178 209.667 49.4465 208.039 48.1983 207.76L45.9289 207.254L46.1983 185.62L46.4678 163.986L54.9678 162.046C88.4685 154.397 144.731 140.301 190.968 127.972C294.298 100.418 305.293 97.6847 326.468 94.2905C399.015 82.6617 438.69 89.9262 590.279 142.594C618.789 152.5 650.42 154.979 678.004 149.47C684.349 148.203 691.511 147.309 693.92 147.484L698.301 147.802L707.583 168.302C712.689 179.577 716.889 189.056 716.917 189.366C716.945 189.676 710.78 190.722 703.218 191.689C644.866 199.154 611.667 212.619 592.861 236.45C578.835 254.224 575.167 262.105 572.355 280.51C568.023 308.869 574.567 318.992 606.191 332.855C614.303 336.411 614.333 336.512 607.718 338.045C582.298 343.933 570.552 357.725 557.982 396.44C537.718 458.855 517.944 494.887 501.792 498.828C499.253 499.448 499.083 499.252 498.439 494.958ZM440.19 236.933C490.947 231.661 549.661 212.316 584.308 189.451L588.149 186.916L580.641 183.138C560.591 173.05 531.888 162.396 493.825 150.914C484.342 148.053 450.673 140.296 431.5 136.5C431.5 136.5 418.923 132.671 379.968 132.671C351.5 132.671 327.78 136.28 328 136.5C296 143.5 269.986 150.242 232.723 159.892C200.344 168.276 159.829 178.181 133.968 184.035L125.468 185.959L138.968 190.15C146.393 192.455 170.693 200.376 192.968 207.753C250.872 226.929 283.339 234.224 328.863 238.289C344.325 239.669 423.085 238.71 440.19 236.933ZM51.3227 121.688C51.6843 111.3 52.5399 99.2017 53.224 94.8017L54.4678 86.8017L72.4678 86.7728C105.029 86.7207 121.104 82.6015 214.468 50.3851C289.353 24.5451 365.44 14.3673 419.018 23.0235C464.704 30.4046 515.518 43.6119 573.968 63.2963C631.345 82.6195 662.115 85.7278 697.468 75.7715C700.605 74.8879 719.56 107.99 717.328 110.456C715.526 112.447 708.312 115.414 697.968 118.419C687.562 121.441 644.592 122.379 630.212 119.897C619.391 118.03 577.046 105.995 548.468 96.664C474.545 72.5288 385.996 60.4876 334.968 67.6314C289.583 73.9852 271.84 78.3512 214.682 97.231C147.484 119.427 88.6243 135.204 55.5664 139.881L50.6651 140.574L51.3227 121.688Z"
      />
    </svg>
  );
}
